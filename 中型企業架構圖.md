---
tags: SRE
---

# 中型企業網路架構
---
* 模擬企業網路架構

---

* VMware總共有的虛擬機

![](https://i.imgur.com/Rf2D3cP.png)

1. 一台XP系統的電腦(hostonly)
2. 一台插兩個網卡的alpine(nat、hostonly)
3. 另一台插兩個網卡的alpine(bridge、nat)
4. 一台插兩個網卡的UbuntuServer(bridge、nat)

---

* 第一台Alpine的ip設定(bridge、nat)
![](https://i.imgur.com/o9sSEPD.png)

1.檔案位置 `/etc/network/interface`
2.ip、netmask、gateway如圖設定
* etho是Bridge(gateway設在這，因為是代表教室網路所以是120.96.143.254)
* eth1是NAT(IP是第三段的後5的第二個它要當下一個alpine(nat)的出口，遮罩是切四段的遮罩255.255.255.192)
---
* 第一台Alpine的路由開關(bridge、nat)
![](https://i.imgur.com/ZLY6WEJ.png)

1.檔案位置 `/etc/sysctl.conf`
2.打上`net.ipv4.ip_forward = 1`這樣就可以把alpine變成Router

---
* 第一台Alpine的路由表新增(bridge、nat)
![](https://i.imgur.com/VfAnRwY.png)

1.打上 route add -net 目的地網段 netmask 遮罩 目的地遮罩 gw 進去的入口
2.chmod +x 檔案
3.因為是.start檔要開始開機時就執行的設定`rc-update add local`
4.reboot 就會自動建好路由表了

---
* UbuntuServer的ip設定(bridge、nat)
![](https://i.imgur.com/F72nETH.png)
1.ens32的IP跟第一台apline一樣也是對外，所以遮罩和出口也是代表教室網路的遮罩和出口
2.ens35的IP也是設定第三段的後5來設定，遮罩也是切四段
3.設定好先try `sudo netplan try`
4.可以就直接apply `sudo netplan apply`

---
* UbuntuServer的路由設定(bridge、nat)
![](https://i.imgur.com/1wCkJB9.png)
1.檔案位置 /etc/rc.local

















